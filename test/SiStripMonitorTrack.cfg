process SiStripDQM = {

    service = MessageLogger
    {
#       untracked vstring destinations   = { "cout" }
	untracked vstring destinations = {
	    "debug.txt",
	    "error.txt"
	}
	untracked PSet error.txt = { untracked string threshold = "INFO"    }
	untracked PSet debug.txt = { untracked string threshold = "DEBUG"    }

#       untracked vstring categories     = { "SiStripMonitorTrack" }
#       untracked PSet cout       = { untracked string threshold = "INFO" }
       untracked vstring debugModules    = { "*" }
    }

    #++++++++++++
    #Geometry
    #++++++++++++
   
    include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
    include "Geometry/TrackerRecoData/data/trackerRecoGeometryXML.cfi"
    include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
    
    #SiStripClusterInfo if necessary (add it also in the path)...
#    include "AnalysisAlgos/SiStripClusterInfoProducer/data/SiStripClusterInfoProducer.cfi"
 #-------------------------------------------------
  ## CALIBRATION
  #-------------------------------------------------

    ## CABLING
    include "CalibTracker/Configuration/data/SiStrip_FrontierCabling.cfi"
    replace siStripFedCabling.connect="sqlite_file:/afs/cern.ch/user/g/giordano/public/SQLITE/SiStripCabling_18X.db"
    replace siStripFedCabling.toGet= {{ string record = "SiStripFedCablingRcd" string tag = "SiStripCabling_pass4_18X_v1"}}
    replace siStripFedCabling.DBParameters.authenticationPath="/afs/cern.ch/cms/DB/conddb"

    ## PEDESTALS
    include "CalibTracker/Configuration/data/SiStrip_FrontierPedestals.cfi"
    replace siStripPedestals.toGet={   { string record = "SiStripPedestalsRcd"  string tag = "SiStripPedestals_pass4_test_v1_p"}  }
    replace siStripPedestals.connect = "oracle://cms_orcoff_int2r/CMS_COND_STRIP"
    ## to use Frontier
    ## replace siStripPedestals.connect = "frontier://FrontierDev/CMS_COND_STRIP"
    replace siStripPedestals.DBParameters.authenticationPath="/afs/cern.ch/cms/DB/conddb"

    ## NOISE
    include "CalibTracker/Configuration/data/SiStrip_FrontierNoise.cfi"
    replace siStripNoise.toGet={ { string record = "SiStripNoisesRcd"     string tag = "SiStripNoises_pass4_test_v1_n"} }
    replace siStripNoise.connect = "oracle://cms_orcoff_int2r/CMS_COND_STRIP"
    ## to use Frontier
    ## replace siStripNoise.connect = "frontier://FrontierDev/CMS_COND_STRIP"  
    replace siStripNoise.DBParameters.authenticationPath="/afs/cern.ch/cms/DB/conddb"

    ## GAIN
    # Gain in TBufferStream needs to be uploaded, for the time being use fake source       ## FAKE CONDITIONS
    include "CalibTracker/Configuration/data/SiStrip_FrontierGain.cfi"
    replace siStripApvGain.toGet={
	{ string record = "SiStripApvGainRcd" string tag = "SiStripApvGain_TickMarksfromASCII_TBuffer_v1" } }
    replace siStripApvGain.connect = "oracle://cms_orcoff_int2r/CMS_COND_STRIP"
    ## to use Frontier
    ## replace siStripApvGain.connect = "frontier://FrontierDev/CMS_COND_STRIP"  
    replace siStripApvGain.DBParameters.authenticationPath="/afs/cern.ch/cms/DB/conddb"
  
    ## SiStripQuality
    es_source a = PoolDBESSource {
	string appendToDataLabel = "SiStripBadModule_v1"
	VPSet toGet = {	{ string record = "SiStripBadModuleRcd"  string tag = "SiStripBadModule_TBuffer_VenturiList_v1"} }
	string connect = "oracle://cms_orcoff_int2r/CMS_COND_STRIP" 
	#string connect = "sqlite_file:dbfile.db"
	string timetype = "runnumber"
	untracked string BlobStreamerName="TBufferBlobStreamingService"	   
 	PSet DBParameters ={
	    untracked string authenticationPath="/afs/cern.ch/cms/DB/conddb"
	}
    }

    es_source b = PoolDBESSource {
	string appendToDataLabel = "SiStripBadFiber_v1"
	VPSet toGet = {	{ string record = "SiStripBadFiberRcd"   string tag = "SiStripBadFiber_TBuffer_VenturiList_v1"} }
	string connect = "oracle://cms_orcoff_int2r/CMS_COND_STRIP" 
	#string connect = "sqlite_file:dbfile.db"
	string timetype = "runnumber"
	untracked string BlobStreamerName="TBufferBlobStreamingService"
     	PSet DBParameters ={
	    untracked string authenticationPath="/afs/cern.ch/cms/DB/conddb"
	}
    }

    es_module = SiStripQualityESProducer {
	
	string appendToDataLabel = "test1"

	untracked bool PrintDebug=true
	
	VPSet ListOfRecordToMerge = {
	    { string record = "SiStripBadModuleRcd"  string tag = "SiStripBadModule_v1"} ,
	    { string record = "SiStripBadFiberRcd"   string tag = "SiStripBadFiber_v1"} 
	}    	
    }


    #### MonitorPedestal ####
    # SiStripMonitorPedestals
    include "DQM/SiStripMonitorPedestals/data/SiStripMonitorPedestals.cfi"
    replace PedsMon.OutputMEsInRootFile = false


    #### SiStripMonitorCluster ####
    include "DQM/SiStripMonitorCluster/data/SiStripMonitorCluster.cfi"
    # use the following flag to select all detectors (e.g. for mtcc data). by default is false
    replace SiStripMonitorCluster.FillSignalNoiseHistos = false
    replace SiStripMonitorCluster.OutputMEsInRootFile = false
    replace SiStripMonitorCluster.SelectAllDetectors = true

    #### SiStripMonitorQuality
    include "DQM/SiStripMonitorPedestals/data/SiStripMonitorQuality.cfi"

    ####  SiStripMonitorAnalyser) ####
    module sistripAnalyser = SiStripAnalyser {
	untracked int32  StaticUpdateFrequency = 2
	untracked int32  TkMapCreationFrequency = 2
	untracked int32  SummaryCreationFrequency = 2
	PSet TkmapParameters =
	{
            untracked string trackerdatPath="CommonTools/TrackerMap/data/"
            untracked string trackermaptxtPath="CommonTools/TrackerMap/data/"
            untracked bool loadFedCabling=true
	}
	
    }
    
    #     # > Cabling and Pedestals <
    #     # read cabling and pedestals from DB
    #     es_source = PoolDBESSource {
    #        VPSet toGet = {
    #            { string record = "SiStripFedCablingRcd" string tag = "SiStripCabling_TIF_29062007_test1"},
    #            { string record = "SiStripNoisesRcd" string tag = "SiStripPedNoise_TIF_29062007_test1_n"},
    #            { string record = "SiStripPedestalsRcd" string tag= "SiStripPedNoise_TIF_29062007_test1_p"}
    #        }
    
    #         bool loadAll = true
    #         string connect = "sqlite_file:/afs/cern.ch/user/g/giordano/public/160Check/dummy_8055.db"
    #         untracked string catalog = "file:/afs/cern.ch/user/g/giordano/public/160Check/dummy_8055.xml"
    #         string timetype = "runnumber"
    #         PSet DBParameters = {
    #             untracked string authenticationPath="/afs/cern.ch/cms/DB/conddb"
    #             untracked int32 messageLevel = 1
    #             untracked bool loadBlobStreamer = true
    #         }
    #     }
    
    # DQM services
    service = DaqMonitorROOTBackEnd{}
    # produce SiStripFecCabling and SiStripDetCabling out of SiStripFedCabling
//    es_module sistripconn = SiStripConnectivity {}
    
     
    #=========================================================================================
    #  Sources
    source = PoolSource {

	untracked vstring fileNames = { "file:/tmp/maborgia/run8055_172_ALIGNMENT_QUALITY_GAIN.root"}
    }
    untracked PSet maxEvents = {untracked int32 input = -1}
    # End Sources
    #=========================================================================================

    //
    // The ReFitter was only used for trying the MonitorTrackResiduals package
    //
    // Most of these entries are not really needed, but they are providing some Records
    // which I did not look up separately
    //
#     include "RecoTracker/TrackProducer/data/RefitterWithMaterial.cff"
#     //replace TrackRefitter.src = "AlignmentTracks"
#     replace TrackRefitter.src = "ctfWithMaterialTracksTIF"
#     replace TrackRefitter.TrajectoryInEvent = true
#     # needed for refit of hits:
#     include "CalibTracker/Configuration/data/SiStrip_FakeLorentzAngle.cff"
#     # usually without refit:
#     replace TrackRefitter.TTRHBuilder = "WithTrackAngle"# TransientTrackingRecHitBuilder: no refit of hits...
#     include "RecoTracker/TransientTrackingRecHit/data/TransientTrackingRecHitBuilderWithoutRefit.cfi"
#     # ... but matching for strip stereo should be redone:
#     replace ttrhbwor.Matcher = "StandardMatcher"
#     # beam halo propagation needs larger phi changes going from one TEC to another
#     # replace MaterialPropagator.MaxDPhi = 1000.




   ################ MonitorAnalysis ################
    include "DQM/SiStripMonitorTrack/data/SiStripMonitorTrack.cfi"
             //DQM/SiStripMonitorTrack/data/SiStripMonitorTrack.cfi
#    replace SiStripMonitorTrack.TrackProducer= TRACKRECONSTRUCTION
    replace SiStripMonitorTrack.Track_src = "ctfWithMaterialTracksTIF"
    replace SiStripMonitorTrack.TrackInfo = "trackinfoCTFTIF"
    replace SiStripMonitorTrack.OutputMEsInRootFile = true
    replace SiStripMonitorTrack.OutputFileName= "/tmp/maborgia/sistripmonitortrack_ctfTIF_Info.root"
#    replace SiStripMonitorTrack.ClusterInfo_src = "siStripClusterInfo"

    replace SiStripMonitorTrack.Cluster_src = siStripClusters
  # End Modules Configuration
  #=========================================================================================

  #=========================================================================================
  # Schedule
//    module evcon = EventContentAnalyzer{}

    path pMonitor = { SiStripMonitorTrack }

  # End Schedule
  #=========================================================================================
}

